<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tateti</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f4f4f4;
    text-align: center;
    margin: 0;
    padding: 0;
  }
  .logo {
    display: block;
    margin: 20px auto;
    max-width: 150px;
    animation: fadeIn 1.5s ease-in-out;
  }
  @keyframes fadeIn {
    from {opacity: 0; transform: translateY(-20px);}
    to {opacity: 1; transform: translateY(0);}
  }
  h1 {
    margin-top: 0;
  }
  .board {
    display: grid;
    grid-template-columns: repeat(3, 100px);
    grid-template-rows: repeat(3, 100px);
    gap: 5px;
    justify-content: center;
    margin: 20px auto;
  }
  .cell {
    background: white;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 2em;
    cursor: pointer;
    transition: background 0.3s;
  }
  .cell:hover {
    background: #eee;
  }
  .controls {
    margin: 10px;
  }
  select, button {
    padding: 5px 10px;
    margin: 5px;
  }
</style>
</head>
<body>
  <img src="logo.png" alt="Logo Colegio" class="logo">
  <h1>Tateti</h1>
  <div class="controls">
    <label for="difficulty">Dificultad:</label>
    <select id="difficulty">
      <option value="easy">Fácil</option>
      <option value="medium">Medio</option>
      <option value="hard">Imposible</option>
    </select>
    <button onclick="resetGame()">Reiniciar</button>
  </div>
  <div class="board" id="board"></div>
  <h2 id="status"></h2>

<script>
  const boardEl = document.getElementById('board');
  const statusEl = document.getElementById('status');
  const difficultyEl = document.getElementById('difficulty');
  let board = Array(9).fill('');
  let currentPlayer = 'X';

  function renderBoard() {
    boardEl.innerHTML = '';
    board.forEach((cell, i) => {
      const cellEl = document.createElement('div');
      cellEl.classList.add('cell');
      cellEl.textContent = cell;
      cellEl.addEventListener('click', () => makeMove(i));
      boardEl.appendChild(cellEl);
    });
  }

  function makeMove(index) {
    if (board[index] || checkWinner()) return;
    board[index] = currentPlayer;
    if (checkWinner()) {
      statusEl.textContent = `¡Jugador ${currentPlayer} gana!`;
    } else if (board.every(cell => cell)) {
      statusEl.textContent = '¡Empate!';
    } else {
      currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
      if (currentPlayer === 'O') aiMove();
    }
    renderBoard();
  }

  function aiMove() {
    let move;
    if (difficultyEl.value === 'easy') {
      const available = board.map((c,i) => c ? null : i).filter(v => v !== null);
      move = available[Math.floor(Math.random() * available.length)];
    } else if (difficultyEl.value === 'medium') {
      move = findBestMove() || board.findIndex(c => !c);
    } else {
      move = findBestMove(true);
    }
    if (move !== undefined) makeMove(move);
  }

  function findBestMove(usePerfect = false) {
    if (!usePerfect) return null;
    let bestScore = -Infinity;
    let move;
    for (let i = 0; i < 9; i++) {
      if (!board[i]) {
        board[i] = 'O';
        let score = minimax(board, 0, false);
        board[i] = '';
        if (score > bestScore) {
          bestScore = score;
          move = i;
        }
      }
    }
    return move;
  }

  function minimax(newBoard, depth, isMaximizing) {
    let winner = checkWinner();
    if (winner === 'O') return 1;
    if (winner === 'X') return -1;
    if (newBoard.every(c => c)) return 0;
    if (isMaximizing) {
      let bestScore = -Infinity;
      for (let i = 0; i < 9; i++) {
        if (!newBoard[i]) {
          newBoard[i] = 'O';
          let score = minimax(newBoard, depth + 1, false);
          newBoard[i] = '';
          bestScore = Math.max(score, bestScore);
        }
      }
      return bestScore;
    } else {
      let bestScore = Infinity;
      for (let i = 0; i < 9; i++) {
        if (!newBoard[i]) {
          newBoard[i] = 'X';
          let score = minimax(newBoard, depth + 1, true);
          newBoard[i] = '';
          bestScore = Math.min(score, bestScore);
        }
      }
      return bestScore;
    }
  }

  function checkWinner() {
    const winPatterns = [
      [0,1,2],[3,4,5],[6,7,8],
      [0,3,6],[1,4,7],[2,5,8],
      [0,4,8],[2,4,6]
    ];
    for (const [a,b,c] of winPatterns) {
      if (board[a] && board[a] === board[b] && board[a] === board[c]) {
        return board[a];
      }
    }
    return null;
  }

  function resetGame() {
    board = Array(9).fill('');
    currentPlayer = 'X';
    statusEl.textContent = '';
    renderBoard();
  }

  renderBoard();
</script>
</body>
</html>
